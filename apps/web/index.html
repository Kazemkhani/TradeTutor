<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#0d1117">
    <meta name="description" content="Learn trading concepts through personalized voice conversations. AI tutor that adapts to your level - from beginner to advanced.">
    <title>TradeTutor - Personalized Trading Education via Voice AI</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* =========================================================
           WORLD-CLASS DESIGN SYSTEM
           Inspired by: Linear, Vercel, Stripe, Apple
           ========================================================= */

        :root {
            /* Dark background palette */
            --bg-primary: #0a0a0b;
            --bg-secondary: #111113;
            --bg-tertiary: #18181b;
            --bg-elevated: #1c1c1f;
            --bg-glass: rgba(255, 255, 255, 0.03);
            --bg-glass-hover: rgba(255, 255, 255, 0.06);

            /* Borders */
            --border-default: rgba(255, 255, 255, 0.08);
            --border-subtle: rgba(255, 255, 255, 0.04);
            --border-accent: rgba(99, 102, 241, 0.5);

            /* Primary - Indigo/Purple gradient */
            --accent: #6366f1;
            --accent-hover: #818cf8;
            --accent-muted: rgba(99, 102, 241, 0.15);
            --accent-glow: rgba(99, 102, 241, 0.4);

            /* Secondary accent - Emerald */
            --success: #10b981;
            --success-muted: rgba(16, 185, 129, 0.15);

            /* Text */
            --text-primary: #fafafa;
            --text-secondary: #a1a1aa;
            --text-muted: #71717a;

            /* Semantic */
            --error: #ef4444;
            --error-muted: rgba(239, 68, 68, 0.15);
            --warning: #f59e0b;

            /* Typography */
            --font-family: 'Inter', -apple-system, BlinkMacSystemFont, system-ui, sans-serif;

            /* Gradients */
            --gradient-text: linear-gradient(135deg, #fff 0%, #a1a1aa 100%);
            --gradient-accent: linear-gradient(135deg, #6366f1 0%, #8b5cf6 50%, #a855f7 100%);
            --gradient-glow: radial-gradient(ellipse at center, var(--accent-glow) 0%, transparent 70%);

            /* Spacing */
            --space-1: 4px;
            --space-2: 8px;
            --space-3: 12px;
            --space-4: 16px;
            --space-5: 20px;
            --space-6: 24px;
            --space-8: 32px;
            --space-10: 40px;
            --space-12: 48px;
            --space-16: 64px;
            --space-20: 80px;
            --space-24: 96px;

            /* Radius */
            --radius-sm: 6px;
            --radius-md: 8px;
            --radius-lg: 12px;
            --radius-xl: 16px;
            --radius-2xl: 24px;

            /* Shadows */
            --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.5);
            --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.4);
            --shadow-lg: 0 8px 32px rgba(0, 0, 0, 0.5);
            --shadow-glow: 0 0 60px var(--accent-glow);
        }

        *, *::before, *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html {
            font-size: 16px;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            scroll-behavior: smooth;
        }

        body {
            font-family: var(--font-family);
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
        }

        /* =========================================================
           ANIMATED BACKGROUND
           ========================================================= */

        .bg-gradient {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: -1;
            overflow: hidden;
        }

        .bg-gradient::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background:
                radial-gradient(ellipse at 20% 20%, rgba(99, 102, 241, 0.15) 0%, transparent 50%),
                radial-gradient(ellipse at 80% 80%, rgba(139, 92, 246, 0.1) 0%, transparent 50%),
                radial-gradient(ellipse at 50% 50%, rgba(168, 85, 247, 0.05) 0%, transparent 50%);
            animation: bgFloat 20s ease-in-out infinite;
        }

        @keyframes bgFloat {
            0%, 100% { transform: translate(0, 0) rotate(0deg); }
            33% { transform: translate(2%, 2%) rotate(1deg); }
            66% { transform: translate(-1%, 1%) rotate(-1deg); }
        }

        /* Grid pattern overlay */
        .bg-grid {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: -1;
            background-image:
                linear-gradient(rgba(255,255,255,0.02) 1px, transparent 1px),
                linear-gradient(90deg, rgba(255,255,255,0.02) 1px, transparent 1px);
            background-size: 64px 64px;
            mask-image: radial-gradient(ellipse at center, black 0%, transparent 70%);
        }

        /* =========================================================
           NAVIGATION
           ========================================================= */

        .nav {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 100;
            padding: var(--space-4) var(--space-6);
            background: rgba(10, 10, 11, 0.8);
            backdrop-filter: blur(12px);
            border-bottom: 1px solid var(--border-subtle);
        }

        .nav-inner {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .nav-logo {
            display: flex;
            align-items: center;
            gap: var(--space-3);
            text-decoration: none;
        }

        .nav-logo-icon {
            width: 32px;
            height: 32px;
            background: var(--gradient-accent);
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .nav-logo-icon svg {
            width: 18px;
            height: 18px;
            color: white;
        }

        .nav-logo-text {
            font-size: 18px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .nav-links {
            display: flex;
            align-items: center;
            gap: var(--space-6);
        }

        .nav-link {
            font-size: 14px;
            color: var(--text-secondary);
            text-decoration: none;
            transition: color 0.2s;
        }

        .nav-link:hover {
            color: var(--text-primary);
        }

        .nav-cta {
            padding: var(--space-2) var(--space-4);
            font-size: 14px;
            font-weight: 500;
            color: white;
            background: var(--gradient-accent);
            border: none;
            border-radius: var(--radius-md);
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .nav-cta:hover {
            transform: translateY(-1px);
            box-shadow: var(--shadow-glow);
        }

        /* =========================================================
           HERO SECTION
           ========================================================= */

        .hero {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: var(--space-24) var(--space-6) var(--space-16);
            text-align: center;
            position: relative;
        }

        .hero-badge {
            display: inline-flex;
            align-items: center;
            gap: var(--space-2);
            padding: var(--space-2) var(--space-4);
            background: var(--bg-glass);
            border: 1px solid var(--border-default);
            border-radius: 100px;
            font-size: 13px;
            color: var(--text-secondary);
            margin-bottom: var(--space-8);
            animation: fadeInUp 0.6s ease-out;
        }

        .hero-badge-dot {
            width: 6px;
            height: 6px;
            background: var(--success);
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.5; transform: scale(1.2); }
        }

        .hero-title {
            font-size: clamp(40px, 8vw, 72px);
            font-weight: 700;
            line-height: 1.1;
            letter-spacing: -0.02em;
            margin-bottom: var(--space-6);
            animation: fadeInUp 0.6s ease-out 0.1s both;
        }

        .hero-title-gradient {
            background: var(--gradient-accent);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .hero-subtitle {
            font-size: clamp(18px, 3vw, 22px);
            color: var(--text-secondary);
            max-width: 640px;
            margin: 0 auto var(--space-10);
            line-height: 1.6;
            animation: fadeInUp 0.6s ease-out 0.2s both;
        }

        .hero-cta-group {
            display: flex;
            align-items: center;
            gap: var(--space-4);
            margin-bottom: var(--space-8);
            animation: fadeInUp 0.6s ease-out 0.3s both;
        }

        .btn-primary {
            display: inline-flex;
            align-items: center;
            gap: var(--space-2);
            padding: var(--space-4) var(--space-8);
            font-size: 16px;
            font-weight: 600;
            color: white;
            background: var(--gradient-accent);
            border: none;
            border-radius: var(--radius-lg);
            cursor: pointer;
            transition: all 0.2s;
            text-decoration: none;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-glow);
        }

        .btn-primary svg {
            width: 18px;
            height: 18px;
        }

        .btn-secondary {
            display: inline-flex;
            align-items: center;
            gap: var(--space-2);
            padding: var(--space-4) var(--space-6);
            font-size: 16px;
            font-weight: 500;
            color: var(--text-secondary);
            background: transparent;
            border: 1px solid var(--border-default);
            border-radius: var(--radius-lg);
            cursor: pointer;
            transition: all 0.2s;
            text-decoration: none;
        }

        .btn-secondary:hover {
            color: var(--text-primary);
            border-color: var(--text-muted);
            background: var(--bg-glass);
        }

        .hero-features {
            display: flex;
            align-items: center;
            gap: var(--space-6);
            font-size: 14px;
            color: var(--text-muted);
            animation: fadeInUp 0.6s ease-out 0.4s both;
        }

        .hero-feature {
            display: flex;
            align-items: center;
            gap: var(--space-2);
        }

        .hero-feature svg {
            width: 16px;
            height: 16px;
            color: var(--success);
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* =========================================================
           LOGOS SECTION
           ========================================================= */

        .logos {
            padding: var(--space-16) var(--space-6);
            text-align: center;
            border-top: 1px solid var(--border-subtle);
        }

        .logos-title {
            font-size: 13px;
            font-weight: 500;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: var(--space-8);
        }

        .logos-grid {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-12);
            flex-wrap: wrap;
            max-width: 900px;
            margin: 0 auto;
            opacity: 0.6;
        }

        .logo-item {
            font-size: 20px;
            font-weight: 600;
            color: var(--text-secondary);
            display: flex;
            align-items: center;
            gap: var(--space-2);
        }

        .logo-item svg {
            width: 24px;
            height: 24px;
        }

        /* =========================================================
           STATS SECTION
           ========================================================= */

        .stats {
            padding: var(--space-16) var(--space-6);
            background: var(--bg-secondary);
            border-top: 1px solid var(--border-subtle);
            border-bottom: 1px solid var(--border-subtle);
        }

        .stats-grid {
            max-width: 1000px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: var(--space-8);
        }

        .stat-item {
            text-align: center;
        }

        .stat-value {
            font-size: 48px;
            font-weight: 700;
            background: var(--gradient-accent);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            line-height: 1;
            margin-bottom: var(--space-2);
        }

        .stat-label {
            font-size: 14px;
            color: var(--text-muted);
        }

        /* =========================================================
           FEATURES SECTION
           ========================================================= */

        .features {
            padding: var(--space-24) var(--space-6);
        }

        .section-header {
            text-align: center;
            margin-bottom: var(--space-16);
        }

        .section-label {
            font-size: 13px;
            font-weight: 600;
            color: var(--accent);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: var(--space-4);
        }

        .section-title {
            font-size: clamp(32px, 5vw, 48px);
            font-weight: 700;
            margin-bottom: var(--space-4);
        }

        .section-subtitle {
            font-size: 18px;
            color: var(--text-secondary);
            max-width: 600px;
            margin: 0 auto;
        }

        .features-grid {
            max-width: 1100px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: var(--space-6);
        }

        .feature-card {
            padding: var(--space-8);
            background: var(--bg-glass);
            border: 1px solid var(--border-default);
            border-radius: var(--radius-xl);
            transition: all 0.3s;
        }

        .feature-card:hover {
            background: var(--bg-glass-hover);
            border-color: var(--border-accent);
            transform: translateY(-4px);
        }

        .feature-icon {
            width: 48px;
            height: 48px;
            background: var(--accent-muted);
            border-radius: var(--radius-lg);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: var(--space-5);
        }

        .feature-icon svg {
            width: 24px;
            height: 24px;
            color: var(--accent);
        }

        .feature-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: var(--space-2);
        }

        .feature-desc {
            font-size: 14px;
            color: var(--text-secondary);
            line-height: 1.6;
        }

        /* =========================================================
           TESTIMONIALS SECTION
           ========================================================= */

        .testimonials {
            padding: var(--space-24) var(--space-6);
            background: var(--bg-secondary);
            border-top: 1px solid var(--border-subtle);
        }

        .testimonials-grid {
            max-width: 1100px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: var(--space-6);
        }

        .testimonial-card {
            padding: var(--space-6);
            background: var(--bg-tertiary);
            border: 1px solid var(--border-default);
            border-radius: var(--radius-xl);
        }

        .testimonial-stars {
            display: flex;
            gap: 2px;
            margin-bottom: var(--space-4);
        }

        .testimonial-stars svg {
            width: 16px;
            height: 16px;
            color: #fbbf24;
            fill: #fbbf24;
        }

        .testimonial-text {
            font-size: 15px;
            color: var(--text-secondary);
            line-height: 1.7;
            margin-bottom: var(--space-5);
        }

        .testimonial-author {
            display: flex;
            align-items: center;
            gap: var(--space-3);
        }

        .testimonial-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--gradient-accent);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 14px;
            color: white;
        }

        .testimonial-name {
            font-size: 14px;
            font-weight: 600;
        }

        .testimonial-role {
            font-size: 13px;
            color: var(--text-muted);
        }

        /* =========================================================
           SECURITY SECTION
           ========================================================= */

        .security {
            padding: var(--space-16) var(--space-6);
            text-align: center;
            border-top: 1px solid var(--border-subtle);
        }

        .security-badges {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-8);
            flex-wrap: wrap;
        }

        .security-badge {
            display: flex;
            align-items: center;
            gap: var(--space-2);
            padding: var(--space-3) var(--space-5);
            background: var(--bg-glass);
            border: 1px solid var(--border-default);
            border-radius: var(--radius-lg);
            font-size: 13px;
            color: var(--text-secondary);
        }

        .security-badge svg {
            width: 18px;
            height: 18px;
            color: var(--success);
        }

        /* =========================================================
           CTA SECTION
           ========================================================= */

        .cta-section {
            padding: var(--space-24) var(--space-6);
            text-align: center;
            position: relative;
        }

        .cta-section::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 600px;
            height: 600px;
            transform: translate(-50%, -50%);
            background: var(--gradient-glow);
            filter: blur(100px);
            z-index: -1;
        }

        .cta-title {
            font-size: clamp(32px, 5vw, 48px);
            font-weight: 700;
            margin-bottom: var(--space-4);
        }

        .cta-subtitle {
            font-size: 18px;
            color: var(--text-secondary);
            margin-bottom: var(--space-8);
        }

        /* =========================================================
           FORM SECTION (Dashboard)
           ========================================================= */

        .dashboard {
            display: none;
            min-height: 100vh;
            padding: var(--space-20) var(--space-6);
        }

        .dashboard.active {
            display: block;
        }

        .dashboard-container {
            max-width: 520px;
            margin: 0 auto;
        }

        .dashboard-header {
            text-align: center;
            margin-bottom: var(--space-8);
        }

        .dashboard-back {
            display: inline-flex;
            align-items: center;
            gap: var(--space-2);
            font-size: 14px;
            color: var(--text-muted);
            text-decoration: none;
            margin-bottom: var(--space-6);
            transition: color 0.2s;
        }

        .dashboard-back:hover {
            color: var(--text-primary);
        }

        .dashboard-back svg {
            width: 16px;
            height: 16px;
        }

        .dashboard-title {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: var(--space-2);
        }

        .dashboard-subtitle {
            font-size: 14px;
            color: var(--text-muted);
        }

        /* Card styling */
        .card {
            background: var(--bg-secondary);
            border: 1px solid var(--border-default);
            border-radius: var(--radius-xl);
            overflow: hidden;
        }

        .card-header {
            padding: var(--space-6);
            border-bottom: 1px solid var(--border-default);
        }

        .card-body {
            padding: var(--space-6);
        }

        /* Progress indicator */
        .progress {
            display: flex;
            gap: var(--space-2);
            margin-top: var(--space-5);
        }

        .progress-step {
            flex: 1;
            height: 3px;
            background: var(--border-default);
            border-radius: 2px;
            transition: all 0.3s;
        }

        .progress-step.active {
            background: var(--accent);
        }

        .progress-step.completed {
            background: var(--success);
        }

        .progress-text {
            font-size: 12px;
            color: var(--text-muted);
            margin-top: var(--space-3);
        }

        /* Form Elements */
        .form-group {
            margin-bottom: var(--space-5);
        }

        .form-label {
            display: block;
            font-size: 13px;
            font-weight: 500;
            color: var(--text-secondary);
            margin-bottom: var(--space-2);
        }

        .form-label .required {
            color: var(--error);
        }

        .form-input,
        .form-textarea {
            width: 100%;
            padding: var(--space-3) var(--space-4);
            font-size: 15px;
            font-family: inherit;
            color: var(--text-primary);
            background: var(--bg-tertiary);
            border: 1px solid var(--border-default);
            border-radius: var(--radius-md);
            transition: all 0.2s;
        }

        .form-input:focus,
        .form-textarea:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 3px var(--accent-muted);
        }

        .form-input::placeholder,
        .form-textarea::placeholder {
            color: var(--text-muted);
        }

        .form-input.error {
            border-color: var(--error);
        }

        .form-input.error:focus {
            box-shadow: 0 0 0 3px var(--error-muted);
        }

        .form-input.valid {
            border-color: var(--success);
        }

        .form-textarea {
            min-height: 100px;
            resize: vertical;
        }

        .form-hint {
            font-size: 12px;
            color: var(--text-muted);
            margin-top: var(--space-2);
        }

        .form-error {
            font-size: 12px;
            color: var(--error);
            margin-top: var(--space-2);
            display: none;
        }

        .form-error.visible {
            display: block;
        }

        /* Lead cards */
        .lead-cards {
            display: flex;
            flex-direction: column;
            gap: var(--space-4);
        }

        .lead-card {
            position: relative;
            padding: var(--space-5);
            background: var(--bg-tertiary);
            border: 1px solid var(--border-default);
            border-radius: var(--radius-lg);
            transition: border-color 0.2s;
        }

        .lead-card:hover {
            border-color: var(--border-accent);
        }

        .lead-card-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: var(--space-4);
        }

        .lead-card-number {
            font-size: 12px;
            font-weight: 600;
            color: var(--accent);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .lead-card-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: var(--space-3);
        }

        .lead-card-grid .form-group {
            margin-bottom: 0;
        }

        .lead-card-grid .form-group.full-width {
            grid-column: 1 / -1;
        }

        .btn-icon {
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-default);
            border-radius: var(--radius-md);
            color: var(--text-muted);
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn-icon:hover {
            color: var(--error);
            border-color: var(--error);
            background: var(--error-muted);
        }

        .btn-add {
            display: inline-flex;
            align-items: center;
            gap: var(--space-2);
            padding: var(--space-2) 0;
            font-size: 13px;
            font-weight: 500;
            color: var(--accent);
            background: none;
            border: none;
            cursor: pointer;
            transition: opacity 0.2s;
        }

        .btn-add:hover {
            opacity: 0.8;
        }

        .btn-add:disabled {
            opacity: 0.4;
            cursor: not-allowed;
        }

        /* Summary lead card */
        .summary-lead-card {
            padding: var(--space-3) var(--space-4);
            background: var(--bg-tertiary);
            border: 1px solid var(--border-default);
            border-radius: var(--radius-md);
            margin-bottom: var(--space-2);
        }

        .summary-lead-card:last-child {
            margin-bottom: 0;
        }

        .summary-lead-name {
            font-size: 14px;
            font-weight: 500;
            margin-bottom: 2px;
        }

        .summary-lead-detail {
            font-size: 13px;
            color: var(--text-secondary);
            font-family: 'SF Mono', Monaco, monospace;
        }

        .summary-lead-meta {
            font-size: 12px;
            color: var(--text-muted);
            margin-top: 2px;
        }

        /* Goal cards */
        .goal-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: var(--space-3);
        }

        .goal-card {
            position: relative;
            padding: var(--space-4);
            background: var(--bg-tertiary);
            border: 1px solid var(--border-default);
            border-radius: var(--radius-md);
            cursor: pointer;
            transition: all 0.2s;
        }

        .goal-card:hover {
            border-color: var(--text-muted);
        }

        .goal-card.selected {
            border-color: var(--accent);
            background: var(--accent-muted);
        }

        .goal-card input {
            position: absolute;
            opacity: 0;
        }

        .goal-icon {
            width: 24px;
            height: 24px;
            color: var(--text-muted);
            margin-bottom: var(--space-2);
        }

        .goal-card.selected .goal-icon {
            color: var(--accent);
        }

        .goal-title {
            font-size: 14px;
            font-weight: 500;
            margin-bottom: 2px;
        }

        .goal-desc {
            font-size: 12px;
            color: var(--text-muted);
        }

        /* Conditional fields */
        .conditional-fields {
            margin-top: var(--space-5);
            padding-top: var(--space-5);
            border-top: 1px solid var(--border-default);
            display: none;
        }

        .conditional-fields.visible {
            display: block;
            animation: fadeIn 0.2s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(4px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Checkbox */
        .checkbox-group {
            display: flex;
            align-items: flex-start;
            gap: var(--space-3);
            padding: var(--space-4);
            background: var(--bg-tertiary);
            border-radius: var(--radius-md);
            cursor: pointer;
        }

        .checkbox-input {
            width: 18px;
            height: 18px;
            accent-color: var(--accent);
            margin-top: 2px;
        }

        .checkbox-label {
            font-size: 13px;
            color: var(--text-secondary);
            line-height: 1.4;
        }

        /* Buttons */
        .btn-group {
            display: flex;
            gap: var(--space-3);
            margin-top: var(--space-6);
        }

        .btn {
            flex: 1;
            padding: var(--space-3) var(--space-5);
            font-size: 14px;
            font-weight: 500;
            font-family: inherit;
            border-radius: var(--radius-md);
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-2);
        }

        .btn-form-primary {
            background: var(--gradient-accent);
            color: white;
            border: none;
        }

        .btn-form-primary:hover:not(:disabled) {
            transform: translateY(-1px);
            box-shadow: var(--shadow-glow);
        }

        .btn-form-primary:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .btn-form-secondary {
            background: transparent;
            color: var(--text-secondary);
            border: 1px solid var(--border-default);
        }

        .btn-form-secondary:hover {
            color: var(--text-primary);
            border-color: var(--text-muted);
        }

        /* Steps */
        .step-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: var(--space-5);
        }

        .form-step {
            display: none;
        }

        .form-step.active {
            display: block;
            animation: fadeIn 0.25s ease;
        }

        /* Summary */
        .summary-list {
            display: flex;
            flex-direction: column;
            gap: var(--space-4);
        }

        .summary-item {
            padding-bottom: var(--space-4);
            border-bottom: 1px solid var(--border-subtle);
        }

        .summary-item:last-child {
            border-bottom: none;
            padding-bottom: 0;
        }

        .summary-label {
            font-size: 11px;
            font-weight: 500;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: var(--space-1);
        }

        .summary-value {
            font-size: 14px;
        }

        .phone-tag {
            display: inline-block;
            padding: 2px 8px;
            background: var(--bg-tertiary);
            border-radius: 4px;
            font-size: 13px;
            font-family: 'SF Mono', Monaco, monospace;
            margin-right: var(--space-2);
            margin-bottom: var(--space-1);
        }

        @media (max-width: 480px) {
            .lead-card-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Success state */
        .success-state {
            text-align: center;
            padding: var(--space-8) 0;
        }

        .success-icon {
            width: 64px;
            height: 64px;
            margin: 0 auto var(--space-5);
            background: var(--success-muted);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            animation: successPop 0.4s ease;
        }

        @keyframes successPop {
            0% { transform: scale(0); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        .success-icon svg {
            width: 32px;
            height: 32px;
            color: var(--success);
        }

        .success-title {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: var(--space-2);
        }

        .success-message {
            font-size: 14px;
            color: var(--text-secondary);
            margin-bottom: var(--space-6);
        }

        .success-details {
            background: var(--bg-tertiary);
            border-radius: var(--radius-md);
            padding: var(--space-4);
            text-align: left;
        }

        .success-details dt {
            font-size: 11px;
            color: var(--text-muted);
            text-transform: uppercase;
            margin-bottom: 2px;
        }

        .success-details dd {
            font-size: 14px;
            margin-bottom: var(--space-3);
        }

        .success-details dd:last-child {
            margin-bottom: 0;
        }

        /* Voice Call Overlay */
        .voice-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(20px);
            z-index: 200;
            display: flex;
            align-items: center;
            justify-content: center;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .voice-container {
            background: var(--bg-secondary);
            border: 1px solid var(--border-default);
            border-radius: var(--radius-2xl);
            padding: var(--space-8);
            width: 90%;
            max-width: 400px;
            text-align: center;
        }

        .voice-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-6);
        }

        .voice-header h3 {
            font-size: 18px;
            font-weight: 600;
        }

        .voice-visualizer {
            display: flex;
            justify-content: center;
            margin-bottom: var(--space-6);
        }

        .voice-circle {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: var(--accent-muted);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--accent);
            transition: transform 0.1s ease, box-shadow 0.1s ease;
        }

        .voice-circle.speaking {
            animation: pulse 1s ease-in-out infinite;
            box-shadow: 0 0 40px var(--accent-glow);
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .voice-circle.agent-speaking {
            background: var(--success-muted);
            color: var(--success);
            animation: agentPulse 0.6s ease-in-out infinite;
            box-shadow: 0 0 40px rgba(16, 185, 129, 0.4);
        }

        @keyframes agentPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.08); }
        }

        .voice-status {
            color: var(--text-secondary);
            font-size: 14px;
            margin-bottom: var(--space-6);
        }

        .voice-controls {
            display: flex;
            gap: var(--space-4);
            justify-content: center;
        }

        .btn-voice-mute {
            display: flex;
            align-items: center;
            gap: var(--space-2);
            padding: var(--space-3) var(--space-5);
            background: var(--bg-tertiary);
            border: 1px solid var(--border-default);
            border-radius: var(--radius-lg);
            color: var(--text-primary);
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .btn-voice-mute:hover {
            background: var(--bg-elevated);
        }

        .btn-voice-mute.muted {
            background: var(--error-muted);
            border-color: var(--error);
            color: var(--error);
        }

        .btn-voice-end {
            display: flex;
            align-items: center;
            gap: var(--space-2);
            padding: var(--space-3) var(--space-5);
            background: var(--error);
            border: none;
            border-radius: var(--radius-lg);
            color: white;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .btn-voice-end:hover {
            background: #dc2626;
        }

        /* Alert */
        .alert {
            padding: var(--space-4);
            border-radius: var(--radius-md);
            margin-bottom: var(--space-5);
            display: none;
        }

        .alert.visible {
            display: flex;
            gap: var(--space-3);
        }

        .alert-error {
            background: var(--error-muted);
            border: 1px solid rgba(239, 68, 68, 0.3);
            color: var(--error);
        }

        .alert-icon {
            width: 18px;
            height: 18px;
            flex-shrink: 0;
        }

        .alert-content {
            font-size: 13px;
        }

        /* Spinner */
        .spinner {
            width: 16px;
            height: 16px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-top-color: white;
            border-radius: 50%;
            animation: spin 0.6s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* FAQ Section */
        .faq-section {
            max-width: 680px;
            margin: 0 auto;
            padding: var(--space-16) var(--space-6);
        }

        .faq-title {
            font-size: 28px;
            font-weight: 700;
            text-align: center;
            margin-bottom: var(--space-10);
            background: var(--gradient-text);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .faq-item {
            border: 1px solid var(--border-default);
            border-radius: var(--radius-lg);
            margin-bottom: var(--space-3);
            overflow: hidden;
            background: var(--bg-glass);
        }

        .faq-question {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: var(--space-5) var(--space-6);
            cursor: pointer;
            font-size: 15px;
            font-weight: 500;
            color: var(--text-primary);
            transition: background 0.15s ease;
        }

        .faq-question:hover {
            background: var(--bg-glass-hover);
        }

        .faq-question svg {
            width: 18px;
            height: 18px;
            color: var(--text-muted);
            flex-shrink: 0;
            transition: transform 0.2s ease;
        }

        .faq-item.open .faq-question svg {
            transform: rotate(180deg);
        }

        .faq-answer {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.25s ease;
        }

        .faq-answer-inner {
            padding: 0 var(--space-6) var(--space-5);
            font-size: 14px;
            line-height: 1.6;
            color: var(--text-secondary);
        }

        .faq-item.open .faq-answer {
            max-height: 300px;
        }

        /* Footer */
        .footer {
            text-align: center;
            padding: var(--space-8) var(--space-6);
            font-size: 13px;
            color: var(--text-muted);
            border-top: 1px solid var(--border-subtle);
        }

        .footer a {
            color: var(--accent);
            text-decoration: none;
        }

        .footer a:hover {
            text-decoration: underline;
        }

        .footer-links {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-6);
            margin-bottom: var(--space-4);
        }

        /* =========================================================
           RESPONSIVE
           ========================================================= */

        @media (max-width: 900px) {
            .features-grid,
            .testimonials-grid {
                grid-template-columns: 1fr;
            }

            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .nav-links {
                display: none;
            }
        }

        @media (max-width: 640px) {
            .hero {
                padding: var(--space-20) var(--space-4) var(--space-12);
            }

            .hero-cta-group {
                flex-direction: column;
                width: 100%;
            }

            .btn-primary,
            .btn-secondary {
                width: 100%;
                justify-content: center;
            }

            .hero-features {
                flex-direction: column;
                gap: var(--space-3);
            }

            .stats-grid {
                grid-template-columns: 1fr 1fr;
                gap: var(--space-6);
            }

            .stat-value {
                font-size: 36px;
            }

            .logos-grid {
                gap: var(--space-6);
            }

            .logo-item {
                font-size: 16px;
            }

            .security-badges {
                flex-direction: column;
            }

            .goal-grid {
                grid-template-columns: 1fr;
            }

            .btn-group {
                flex-direction: column-reverse;
            }

            .dashboard {
                padding: var(--space-16) var(--space-4);
            }
        }

        /* Landing page visible, dashboard hidden by default */
        .landing {
            display: block;
        }

        .landing.hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="bg-gradient"></div>
    <div class="bg-grid"></div>

    <!-- Navigation -->
    <nav class="nav">
        <div class="nav-inner">
            <a href="#" class="nav-logo" onclick="showLanding()">
                <div class="nav-logo-icon">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"/>
                    </svg>
                </div>
                <span class="nav-logo-text">TradeTutor</span>
            </a>
            <div class="nav-links">
                <a href="#features" class="nav-link">How It Works</a>
                <a href="#testimonials" class="nav-link">Success Stories</a>
                <a href="#" class="nav-link">Topics</a>
                <button class="nav-cta" onclick="showDashboard()">Start Learning</button>
            </div>
        </div>
    </nav>

    <!-- Landing Page -->
    <div class="landing" id="landing">
        <!-- Hero Section -->
        <section class="hero">
            <div class="hero-badge">
                <span class="hero-badge-dot"></span>
                Personalized AI-powered trading education
            </div>

            <h1 class="hero-title">
                Learn Trading With Your<br>
                <span class="hero-title-gradient">Personal AI Tutor</span>
            </h1>

            <p class="hero-subtitle">
                Call TradeTutor and learn options, futures, forex, technical analysis - adapted to YOUR level. From complete beginner to advanced trader.
            </p>

            <div class="hero-cta-group">
                <button class="btn-primary" onclick="showDashboard()">
                    Start Learning Now
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"/>
                    </svg>
                </button>
                <a href="#demo" class="btn-secondary">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" width="18" height="18">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"/>
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                    </svg>
                    Hear Sample Lesson
                </a>
            </div>

            <div class="hero-features">
                <div class="hero-feature">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
                    </svg>
                    Adapts to your level
                </div>
                <div class="hero-feature">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
                    </svg>
                    Voice-based learning
                </div>
                <div class="hero-feature">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
                    </svg>
                    Quiz to verify understanding
                </div>
            </div>
        </section>

        <!-- Logos Section -->
        <section class="logos">
            <p class="logos-title">Learn from experts in trading education</p>
            <div class="logos-grid">
                <div class="logo-item">
                    <svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/></svg>
                    TechCorp
                </div>
                <div class="logo-item">
                    <svg viewBox="0 0 24 24" fill="currentColor"><circle cx="12" cy="12" r="10"/></svg>
                    Acme Inc
                </div>
                <div class="logo-item">
                    <svg viewBox="0 0 24 24" fill="currentColor"><rect x="3" y="3" width="18" height="18" rx="2"/></svg>
                    Globex
                </div>
                <div class="logo-item">
                    <svg viewBox="0 0 24 24" fill="currentColor"><polygon points="12,2 22,22 2,22"/></svg>
                    Initech
                </div>
                <div class="logo-item">
                    <svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
                    Stark
                </div>
            </div>
        </section>

        <!-- Stats Section -->
        <section class="stats">
            <div class="stats-grid">
                <div class="stat-item">
                    <div class="stat-value">10K+</div>
                    <div class="stat-label">Traders Educated</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value">50+</div>
                    <div class="stat-label">Trading Topics</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value">94%</div>
                    <div class="stat-label">Knowledge Retention</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value">24/7</div>
                    <div class="stat-label">Always Available</div>
                </div>
            </div>
        </section>

        <!-- Features Section -->
        <section class="features" id="features">
            <div class="section-header">
                <p class="section-label">How It Works</p>
                <h2 class="section-title">Learn Trading Your Way</h2>
                <p class="section-subtitle">AI-powered personalized education that adapts to your knowledge level in real-time.</p>
            </div>

            <div class="features-grid">
                <div class="feature-card">
                    <div class="feature-icon">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"/>
                        </svg>
                    </div>
                    <h3 class="feature-title">Adaptive Learning</h3>
                    <p class="feature-desc">TradeTutor assesses your current level and adapts explanations - from beginner analogies to advanced technical concepts.</p>
                </div>

                <div class="feature-card">
                    <div class="feature-icon">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"/>
                        </svg>
                    </div>
                    <h3 class="feature-title">Voice Conversations</h3>
                    <p class="feature-desc">Learn through natural dialogue. Ask questions, get clarifications, and have concepts explained just like talking to a mentor.</p>
                </div>

                <div class="feature-card">
                    <div class="feature-icon">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"/>
                        </svg>
                    </div>
                    <h3 class="feature-title">Options & Derivatives</h3>
                    <p class="feature-desc">Master calls, puts, spreads, and strategies. Learn the Greeks, understand risk/reward, and build profitable strategies.</p>
                </div>

                <div class="feature-card">
                    <div class="feature-icon">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"/>
                        </svg>
                    </div>
                    <h3 class="feature-title">Technical Analysis</h3>
                    <p class="feature-desc">Learn to read charts, identify patterns, use indicators like RSI and MACD, and develop your own analysis framework.</p>
                </div>

                <div class="feature-card">
                    <div class="feature-icon">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"/>
                        </svg>
                    </div>
                    <h3 class="feature-title">Risk Management</h3>
                    <p class="feature-desc">Learn position sizing, stop-loss strategies, portfolio allocation, and how to protect your capital like the pros.</p>
                </div>

                <div class="feature-card">
                    <div class="feature-icon">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"/>
                        </svg>
                    </div>
                    <h3 class="feature-title">Quiz & Verify</h3>
                    <p class="feature-desc">After each lesson, TradeTutor quizzes you to verify understanding. Get it wrong? It re-explains with a different approach.</p>
                </div>
            </div>
        </section>

        <!-- Testimonials Section -->
        <section class="testimonials" id="testimonials">
            <div class="section-header">
                <p class="section-label">Success Stories</p>
                <h2 class="section-title">Traders Love TradeTutor</h2>
                <p class="section-subtitle">See what learners have to say about their experience.</p>
            </div>

            <div class="testimonials-grid">
                <div class="testimonial-card">
                    <div class="testimonial-stars">
                        <svg viewBox="0 0 20 20"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/></svg>
                        <svg viewBox="0 0 20 20"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/></svg>
                        <svg viewBox="0 0 20 20"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/></svg>
                        <svg viewBox="0 0 20 20"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/></svg>
                        <svg viewBox="0 0 20 20"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/></svg>
                    </div>
                    <p class="testimonial-text">"I watched 20 YouTube videos on technical analysis. Half were too basic, half were too advanced. TradeTutor asked my level and explained RSI perfectly for where I actually am."</p>
                    <div class="testimonial-author">
                        <div class="testimonial-avatar">AK</div>
                        <div>
                            <div class="testimonial-name">Ahmed Khalil</div>
                            <div class="testimonial-role">Beginner Options Trader</div>
                        </div>
                    </div>
                </div>

                <div class="testimonial-card">
                    <div class="testimonial-stars">
                        <svg viewBox="0 0 20 20"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/></svg>
                        <svg viewBox="0 0 20 20"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/></svg>
                        <svg viewBox="0 0 20 20"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/></svg>
                        <svg viewBox="0 0 20 20"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/></svg>
                        <svg viewBox="0 0 20 20"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/></svg>
                    </div>
                    <p class="testimonial-text">"Every course assumes forex. I trade synthetics. TradeTutor adapted to MY instruments and used examples from the markets I actually trade. Game changer."</p>
                    <div class="testimonial-author">
                        <div class="testimonial-avatar">MR</div>
                        <div>
                            <div class="testimonial-name">Maria Rodriguez</div>
                            <div class="testimonial-role">Synthetic Indices Trader</div>
                        </div>
                    </div>
                </div>

                <div class="testimonial-card">
                    <div class="testimonial-stars">
                        <svg viewBox="0 0 20 20"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/></svg>
                        <svg viewBox="0 0 20 20"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/></svg>
                        <svg viewBox="0 0 20 20"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/></svg>
                        <svg viewBox="0 0 20 20"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/></svg>
                        <svg viewBox="0 0 20 20"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/></svg>
                    </div>
                    <p class="testimonial-text">"I learn better with examples than theory. TradeTutor walked through real scenarios - 'if you bought this call at this price, here's what happens.' Finally clicked!"</p>
                    <div class="testimonial-author">
                        <div class="testimonial-avatar">JT</div>
                        <div>
                            <div class="testimonial-name">James Thompson</div>
                            <div class="testimonial-role">Retail Day Trader</div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Security Section -->
        <section class="security">
            <div class="security-badges">
                <div class="security-badge">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"/>
                    </svg>
                    256-bit SSL Encryption
                </div>
                <div class="security-badge">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"/>
                    </svg>
                    SOC 2 Compliant
                </div>
                <div class="security-badge">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                    </svg>
                    GDPR Ready
                </div>
                <div class="security-badge">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
                    </svg>
                    TCPA Compliant
                </div>
            </div>
        </section>

        <!-- CTA Section -->
        <section class="cta-section">
            <h2 class="cta-title">Ready to Learn Trading Your Way?</h2>
            <p class="cta-subtitle">Start your personalized trading education journey. TradeTutor adapts to YOU.</p>
            <button class="btn-primary" onclick="showDashboard()">
                Start Learning Now
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"/>
                </svg>
            </button>
        </section>

        <!-- FAQ Section -->
        <section class="faq-section">
            <h2 class="faq-title">Frequently Asked Questions</h2>

            <div class="faq-item">
                <div class="faq-question" onclick="toggleFaq(this)">
                    <span>How does TradeTutor assess my trading level?</span>
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/></svg>
                </div>
                <div class="faq-answer"><div class="faq-answer-inner">
                    When you start a session, TradeTutor asks about your experience level and what markets you trade. It then asks targeted questions to understand exactly where you are - whether you're learning candlestick patterns for the first time or diving into advanced options Greeks. Every explanation is then tailored to your assessed level.
                </div></div>
            </div>

            <div class="faq-item">
                <div class="faq-question" onclick="toggleFaq(this)">
                    <span>What trading topics can I learn about?</span>
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/></svg>
                </div>
                <div class="faq-answer"><div class="faq-answer-inner">
                    TradeTutor covers 50+ topics including: Technical Analysis (candlesticks, indicators, chart patterns), Options & Derivatives (calls, puts, Greeks, strategies), Forex & Synthetics, Risk Management (position sizing, stop losses, portfolio allocation), Trading Psychology, and Market Structure. Just tell it what you want to learn.
                </div></div>
            </div>

            <div class="faq-item">
                <div class="faq-question" onclick="toggleFaq(this)">
                    <span>How is this different from YouTube videos or courses?</span>
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/></svg>
                </div>
                <div class="faq-answer"><div class="faq-answer-inner">
                    Unlike static content, TradeTutor adapts in real-time. If you're confused, it explains differently. If you already know something, it skips ahead. It uses examples from YOUR markets (not just forex if you trade synthetics). And it quizzes you to verify understanding - no more "I think I got it" when you didn't.
                </div></div>
            </div>

            <div class="faq-item">
                <div class="faq-question" onclick="toggleFaq(this)">
                    <span>Can TradeTutor help me understand why I lost money?</span>
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/></svg>
                </div>
                <div class="faq-answer"><div class="faq-answer-inner">
                    Yes. Describe your trade - entry, exit, reasoning - and TradeTutor will analyze what went wrong. Was it position sizing? Did you ignore a key indicator? Entered against the trend? It breaks down the specific mistake and teaches the concept behind it so you don't repeat it.
                </div></div>
            </div>

            <div class="faq-item">
                <div class="faq-question" onclick="toggleFaq(this)">
                    <span>I trade synthetics, not forex. Will this work for me?</span>
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/></svg>
                </div>
                <div class="faq-answer"><div class="faq-answer-inner">
                    Absolutely. TradeTutor asks what markets you trade and uses examples from those specific instruments. Whether you trade Volatility 75, Boom/Crash, Step Indices, or any other synthetic, the concepts are explained using scenarios you'll actually encounter. No more mentally translating forex examples.
                </div></div>
            </div>

            <div class="faq-item">
                <div class="faq-question" onclick="toggleFaq(this)">
                    <span>How does the voice-based learning work?</span>
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/></svg>
                </div>
                <div class="faq-answer"><div class="faq-answer-inner">
                    TradeTutor calls your phone and has a natural voice conversation. Ask questions, get explanations, work through examples - all by speaking. It's like having a trading mentor on-demand. Uses LiveKit for real-time voice, Deepgram for speech recognition, ElevenLabs for natural speech, and GPT-4 for intelligent tutoring.
                </div></div>
            </div>
        </section>

        <!-- Footer -->
        <footer class="footer">
            <div class="footer-links">
                <a href="#">Privacy Policy</a>
                <a href="#">Terms of Service</a>
                <a href="#">Contact</a>
            </div>
            <p>TradeTutor &bull; Powered by <a href="https://livekit.io" target="_blank">LiveKit</a> Voice AI</p>
        </footer>
    </div>

    <!-- Dashboard (Form) Section -->
    <div class="dashboard" id="dashboard">
        <div class="dashboard-container">
            <div class="dashboard-header">
                <a href="#" class="dashboard-back" onclick="showLanding()">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
                    </svg>
                    Back to home
                </a>
                <h1 class="dashboard-title">Start Your Trading Lesson</h1>
                <p class="dashboard-subtitle">Tell us what you want to learn and we'll call you</p>
            </div>

            <div class="card">
                <div class="card-header">
                    <div class="progress" role="progressbar" aria-label="Form progress">
                        <div class="progress-step active" data-step="1"></div>
                        <div class="progress-step" data-step="2"></div>
                        <div class="progress-step" data-step="3"></div>
                        <div class="progress-step" data-step="4"></div>
                        <div class="progress-step" data-step="5"></div>
                    </div>
                    <p class="progress-text">Step <span id="currentStepNum">1</span> of 5<span id="currentStepLabel">  Your Info</span></p>
                </div>

                <div class="card-body">
                    <div id="globalError" class="alert alert-error" role="alert" aria-live="polite">
                        <svg class="alert-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                        </svg>
                        <div class="alert-content" id="globalErrorMessage"></div>
                    </div>

                    <form id="callForm" novalidate>
                        <!-- Step 1: Your Information -->
                        <div class="form-step active" data-step="1">
                            <h2 class="step-title">Your Information</h2>

                            <div class="form-group">
                                <label class="form-label" for="owner_email">Email <span class="required">*</span></label>
                                <input type="email" id="owner_email" name="owner_email" class="form-input" placeholder="you@company.com" autocomplete="email" aria-describedby="owner_email_hint owner_email_error">
                                <p class="form-hint" id="owner_email_hint">We'll send a summary of what you learned</p>
                                <p class="form-error" id="owner_email_error" role="alert"></p>
                            </div>
                        </div>

                        <!-- Step 2: Learning Topic -->
                        <div class="form-step" data-step="2">
                            <h2 class="step-title">Choose Your Topic</h2>

                            <div class="goal-grid" role="radiogroup" aria-label="Select learning topic">
                                <label class="goal-card selected" data-topic="options">
                                    <input type="radio" name="topic" value="options" checked>
                                    <input type="hidden" name="goal" value="trade_education">
                                    <svg class="goal-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"/>
                                    </svg>
                                    <div class="goal-title">Options Trading</div>
                                    <div class="goal-desc">Calls, puts, spreads</div>
                                </label>

                                <label class="goal-card" data-topic="technical_analysis">
                                    <input type="radio" name="topic" value="technical_analysis">
                                    <svg class="goal-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"/>
                                    </svg>
                                    <div class="goal-title">Technical Analysis</div>
                                    <div class="goal-desc">Charts, indicators</div>
                                </label>

                                <label class="goal-card" data-topic="forex">
                                    <input type="radio" name="topic" value="forex">
                                    <svg class="goal-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                    </svg>
                                    <div class="goal-title">Forex Trading</div>
                                    <div class="goal-desc">Currency pairs</div>
                                </label>

                                <label class="goal-card" data-topic="risk_management">
                                    <input type="radio" name="topic" value="risk_management">
                                    <svg class="goal-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"/>
                                    </svg>
                                    <div class="goal-title">Risk Management</div>
                                    <div class="goal-desc">Position sizing, stops</div>
                                </label>
                            </div>
                            <p class="form-error" id="goal_error" role="alert"></p>

                            <div class="conditional-fields" id="fields_book_meeting">
                                <div class="form-group">
                                    <label class="form-label" for="booking_link">Booking Link <span class="required">*</span></label>
                                    <input type="url" id="booking_link" name="booking_link" class="form-input" placeholder="https://calendly.com/you/30min">
                                    <p class="form-hint">We'll send this to leads who say yes</p>
                                    <p class="form-error" id="booking_link_error" role="alert"></p>
                                </div>
                            </div>

                            <div class="conditional-fields" id="fields_close_sale">
                                <div class="form-group">
                                    <label class="form-label" for="payment_link">Payment Link <span class="required">*</span></label>
                                    <input type="url" id="payment_link" name="payment_link" class="form-input" placeholder="https://buy.stripe.com/...">
                                    <p class="form-error" id="payment_link_error" role="alert"></p>
                                </div>
                                <div class="form-group">
                                    <label class="form-label" for="pricing_summary">Pricing <span style="color: var(--text-muted)">(optional)</span></label>
                                    <input type="text" id="pricing_summary" name="pricing_summary" class="form-input" placeholder="$99/month, 30-day free trial">
                                </div>
                                <div class="form-group">
                                    <label class="form-label" for="urgency_hook">Urgency Hook <span style="color: var(--text-muted)">(optional)</span></label>
                                    <input type="text" id="urgency_hook" name="urgency_hook" class="form-input" placeholder="50% off this week only">
                                </div>
                            </div>

                            <div class="conditional-fields" id="fields_qualify_collect">
                                <div class="form-group">
                                    <label class="form-label" for="goal_criteria">What to Ask/Collect <span style="color: var(--text-muted)">(optional)</span></label>
                                    <textarea id="goal_criteria" name="goal_criteria" class="form-textarea" placeholder="Budget range, timeline, company size, current solution..." style="min-height: 70px;"></textarea>
                                </div>
                            </div>
                        </div>

                        <!-- Step 3: Learning Topic -->
                        <div class="form-step" data-step="3">
                            <h2 class="step-title">What to Learn</h2>

                            <div class="form-group">
                                <label class="form-label" for="product">Trading Topic <span class="required">*</span></label>
                                <input type="text" id="product" name="product" class="form-input" placeholder="e.g., How to trade covered calls" value="Options trading basics">
                                <p class="form-error" id="product_error" role="alert"></p>
                            </div>

                            <div class="form-group">
                                <label class="form-label" for="context">Your Experience Level <span style="color: var(--text-muted)">(optional)</span></label>
                                <textarea id="context" name="context" class="form-textarea" placeholder="e.g., I've been trading for 6 months, mostly forex. I understand basic candlesticks but struggle with indicators..."></textarea>
                                <p class="form-hint">Help TradeTutor understand where you're starting from</p>
                                <p class="form-error" id="context_error" role="alert"></p>
                            </div>
                        </div>

                        <!-- Step 4: Your Contact -->
                        <div class="form-step" data-step="4">
                            <h2 class="step-title">Call Me to Teach</h2>

                            <div class="lead-cards" id="leadCards"></div>
                            <button type="button" class="btn-add" id="addLeadBtn" aria-label="Add another learner">
                                <svg width="14" height="14" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
                                </svg>
                                Add another learner
                            </button>
                            <p class="form-hint">Add up to 5 phone numbers. We'll call each one for a personalized lesson.</p>
                            <p class="form-error" id="leads_error" role="alert"></p>
                        </div>

                        <!-- Step 5: Review & Confirm -->
                        <div class="form-step" data-step="5">
                            <h2 class="step-title">Review & Confirm</h2>

                            <div class="summary-list" id="summaryList"></div>

                            <div class="form-group" style="margin-top: var(--space-5);">
                                <label class="checkbox-group">
                                    <input type="checkbox" id="consent" name="consent" class="checkbox-input">
                                    <span class="checkbox-label">I confirm these are my phone numbers and agree to the <a href="#" style="color: var(--accent)">Terms of Service</a>.</span>
                                </label>
                                <p class="form-error" id="consent_error" role="alert"></p>
                            </div>
                        </div>

                        <!-- Success State -->
                        <div class="form-step" data-step="success">
                            <div class="success-state">
                                <div class="success-icon">
                                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
                                    </svg>
                                </div>
                                <h2 class="success-title">Lesson Started!</h2>
                                <p class="success-message">TradeTutor is calling you now. Answer to start learning!</p>
                                <dl class="success-details">
                                    <dt>Dispatched</dt>
                                    <dd id="successDispatched"></dd>
                                    <dt>Failed</dt>
                                    <dd id="successFailed"></dd>
                                </dl>
                                <div id="successCallsList" style="margin-top: var(--space-4); text-align: left;"></div>
                                <div class="btn-group" style="margin-top: var(--space-5); flex-direction: column; gap: var(--space-3);">
                                    <button type="button" class="btn btn-form-primary" id="joinCallBtn" onclick="joinAsTestCaller()" style="background: var(--success); display: none;">
                                        <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24" style="margin-right: 8px;">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"/>
                                        </svg>
                                        Join Call as Test Caller
                                    </button>
                                    <button type="button" class="btn btn-form-secondary" onclick="resetForm()">Start Another Lesson</button>
                                </div>
                            </div>
                        </div>

                        <!-- Voice Call Overlay -->
                        <div id="voiceOverlay" class="voice-overlay" style="display: none;">
                            <div class="voice-container">
                                <div class="voice-header">
                                    <h3>Connected to TradeTutor</h3>
                                    <button type="button" class="btn-icon" onclick="disconnectCall()" aria-label="End call">
                                        <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                                        </svg>
                                    </button>
                                </div>
                                <div class="voice-visualizer" id="voiceVisualizer">
                                    <div class="voice-circle" id="voiceCircle">
                                        <svg width="48" height="48" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"/>
                                        </svg>
                                    </div>
                                </div>
                                <p id="voiceStatus" class="voice-status">Connecting...</p>
                                <div class="voice-controls">
                                    <button type="button" class="btn btn-voice-mute" id="muteBtn" onclick="toggleMute()">
                                        <svg id="muteIcon" width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"/>
                                        </svg>
                                        <span id="muteLabel">Mute</span>
                                    </button>
                                    <button type="button" class="btn btn-voice-end" onclick="disconnectCall()">
                                        <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 8l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2M5 3a2 2 0 00-2 2v1c0 8.284 6.716 15 15 15h1a2 2 0 002-2v-3.28a1 1 0 00-.684-.948l-4.493-1.498a1 1 0 00-1.21.502l-1.13 2.257a11.042 11.042 0 01-5.516-5.517l2.257-1.128a1 1 0 00.502-1.21L9.228 3.683A1 1 0 008.279 3H5z"/>
                                        </svg>
                                        End Call
                                    </button>
                                </div>
                            </div>
                        </div>

                        <div class="btn-group" id="navButtons">
                            <button type="button" class="btn btn-form-secondary" id="prevBtn" style="display: none;">Back</button>
                            <button type="button" class="btn btn-form-primary" id="nextBtn">Continue</button>
                        </div>
                    </form>
                </div>
            </div>

            <p class="footer" style="border: none; padding-top: var(--space-6);">
                <span class="security-badge" style="display: inline-flex; margin: 0 auto;">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" width="16" height="16">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"/>
                    </svg>
                    Your data is encrypted and secure
                </span>
            </p>
        </div>
    </div>

    <script>
        // =========================================================
        // STATE MANAGEMENT
        // =========================================================

        const state = {
            currentStep: 1,
            data: {
                owner_email: '',
                leads: [{ name: '', phone: '', company: '', email: '' }],
                product: 'Options Trading',
                website_url: '',
                context: '',
                goal: 'trade_education',
                topic: 'options',
                booking_link: '',
                payment_link: '',
                pricing_summary: '',
                urgency_hook: '',
                goal_criteria: '',
                consent: false
            },
            errors: {},
            isSubmitting: false
        };

        const STEP_LABELS = ['Your Info', 'Goal', 'Product', 'Leads', 'Review'];

        // =========================================================
        // DOM REFERENCES
        // =========================================================

        const form = document.getElementById('callForm');
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');
        const navButtons = document.getElementById('navButtons');
        const leadCardsEl = document.getElementById('leadCards');
        const addLeadBtn = document.getElementById('addLeadBtn');
        const globalError = document.getElementById('globalError');
        const landing = document.getElementById('landing');
        const dashboard = document.getElementById('dashboard');

        // =========================================================
        // VIEW SWITCHING
        // =========================================================

        function toggleFaq(el) {
            el.closest('.faq-item').classList.toggle('open');
        }

        function showLanding() {
            landing.classList.remove('hidden');
            dashboard.classList.remove('active');
            window.scrollTo(0, 0);
            return false;
        }

        function showDashboard() {
            landing.classList.add('hidden');
            dashboard.classList.add('active');
            window.scrollTo(0, 0);
            document.getElementById('owner_email').focus();
        }

        // =========================================================
        // INITIALIZATION
        // =========================================================

        document.addEventListener('DOMContentLoaded', () => {
            loadFromLocalStorage();
            setupEventListeners();
            renderLeadCards();
            updateUI();
        });

        function setupEventListeners() {
            prevBtn.addEventListener('click', () => {
                if (state.currentStep > 1) {
                    state.currentStep--;
                    updateUI();
                    saveToLocalStorage();
                }
            });

            nextBtn.addEventListener('click', () => {
                if (state.currentStep === 5) {
                    submitForm();
                } else {
                    goToStep(state.currentStep + 1);
                }
            });

            addLeadBtn.addEventListener('click', addLeadCard);

            leadCardsEl.addEventListener('click', e => {
                const btn = e.target.closest('[data-remove-lead]');
                if (btn) removeLeadCard(parseInt(btn.dataset.removeLead));
            });

            leadCardsEl.addEventListener('input', e => {
                const field = e.target.dataset.leadField;
                const index = e.target.dataset.leadIndex;
                if (field !== undefined && index !== undefined) {
                    state.data.leads[parseInt(index)][field] = e.target.value;
                    saveToLocalStorage();
                }
            });

            document.querySelectorAll('.goal-card').forEach(card => {
                card.addEventListener('click', () => {
                    if (card.dataset.topic) {
                        selectTopic(card.dataset.topic);
                    } else if (card.dataset.goal) {
                        selectGoal(card.dataset.goal);
                    }
                });
            });

            form.addEventListener('input', handleFormInput);
            form.addEventListener('change', handleFormInput);

            document.addEventListener('keydown', e => {
                if (e.key === 'Enter' && e.target.tagName !== 'TEXTAREA') {
                    e.preventDefault();
                    nextBtn.click();
                }
            });
        }

        // =========================================================
        // NAVIGATION
        // =========================================================

        function goToStep(step) {
            if (step > state.currentStep && !validateCurrentStep()) return;
            state.currentStep = step;
            updateUI();
            saveToLocalStorage();
        }

        function updateUI() {
            // Update step visibility
            document.querySelectorAll('.form-step').forEach(s => {
                const stepNum = s.dataset.step;
                s.classList.toggle('active', stepNum == state.currentStep || (stepNum === 'success' && state.currentStep === 'success'));
            });

            // Update progress bar
            document.querySelectorAll('.progress-step').forEach(d => {
                const n = parseInt(d.dataset.step);
                d.classList.toggle('active', n === state.currentStep);
                d.classList.toggle('completed', n < state.currentStep);
            });

            // Update step counter with label
            const stepNum = document.getElementById('currentStepNum');
            if (stepNum) {
                const label = typeof state.currentStep === 'number' && state.currentStep >= 1 && state.currentStep <= 5
                    ? STEP_LABELS[state.currentStep - 1]
                    : '';
                stepNum.textContent = state.currentStep;
                const stepLabel = document.getElementById('currentStepLabel');
                if (stepLabel) stepLabel.textContent = label ? `  ${label}` : '';
            }

            // Update buttons
            prevBtn.style.display = state.currentStep > 1 && state.currentStep <= 5 ? 'flex' : 'none';

            if (state.currentStep === 5) {
                nextBtn.innerHTML = state.isSubmitting
                    ? '<span class="spinner"></span>Starting Call...'
                    : 'Start Call';
                nextBtn.disabled = state.isSubmitting;
                populateSummary();
            } else {
                nextBtn.textContent = 'Continue';
                nextBtn.disabled = false;
            }

            navButtons.style.display = state.currentStep === 'success' ? 'none' : 'flex';
            updateConditionalFields();

            // Update add lead button state
            if (addLeadBtn) {
                addLeadBtn.disabled = state.data.leads.length >= 5;
            }
        }

        function updateConditionalFields() {
            const g = state.data.goal;
            document.getElementById('fields_book_meeting').classList.toggle('visible', g === 'book_meeting');
            document.getElementById('fields_close_sale').classList.toggle('visible', g === 'close_sale');
            document.getElementById('fields_qualify_collect').classList.toggle('visible', g === 'qualify_interest' || g === 'collect_info');
            document.querySelectorAll('.goal-card').forEach(c => c.classList.toggle('selected', c.dataset.goal === g));
        }

        // =========================================================
        // SUMMARY
        // =========================================================

        function populateSummary() {
            const goalLabels = {
                book_meeting: 'Book Meeting',
                qualify_interest: 'Qualify Lead',
                collect_info: 'Collect Info',
                close_sale: 'Close Sale',
                trade_education: 'Trading Education'
            };

            const leadsHtml = state.data.leads
                .filter(l => l.phone.trim())
                .map(l => {
                    let details = `<div class="summary-lead-detail">${esc(l.phone)}</div>`;
                    const meta = [];
                    if (l.company) meta.push(esc(l.company));
                    if (l.email) meta.push(esc(l.email));
                    if (meta.length) details += `<div class="summary-lead-meta">${meta.join(' &bull; ')}</div>`;
                    return `<div class="summary-lead-card">
                        <div class="summary-lead-name">${esc(l.name) || 'Unnamed lead'}</div>
                        ${details}
                    </div>`;
                }).join('');

            let html = `
                <div class="summary-item">
                    <div class="summary-label">Email</div>
                    <div class="summary-value">${esc(state.data.owner_email)}</div>
                </div>
                <div class="summary-item">
                    <div class="summary-label">Goal</div>
                    <div class="summary-value">${goalLabels[state.data.goal] || ''}</div>
                </div>
            `;

            // Goal-specific fields
            if (state.data.goal === 'book_meeting' && state.data.booking_link) {
                html += `
                    <div class="summary-item">
                        <div class="summary-label">Booking Link</div>
                        <div class="summary-value" style="word-break: break-all;">${esc(state.data.booking_link)}</div>
                    </div>
                `;
            }
            if (state.data.goal === 'close_sale' && state.data.payment_link) {
                html += `
                    <div class="summary-item">
                        <div class="summary-label">Payment Link</div>
                        <div class="summary-value" style="word-break: break-all;">${esc(state.data.payment_link)}</div>
                    </div>
                `;
            }

            html += `
                <div class="summary-item">
                    <div class="summary-label">Product</div>
                    <div class="summary-value">${esc(state.data.product)}</div>
                </div>
            `;

            if (state.data.context) {
                html += `
                    <div class="summary-item">
                        <div class="summary-label">Product Context</div>
                        <div class="summary-value" style="font-size: 13px; color: var(--text-secondary);">${esc(state.data.context).substring(0, 200)}${state.data.context.length > 200 ? '...' : ''}</div>
                    </div>
                `;
            }

            html += `
                <div class="summary-item">
                    <div class="summary-label">Leads (${state.data.leads.filter(l => l.phone.trim()).length})</div>
                    <div class="summary-value">${leadsHtml}</div>
                </div>
            `;

            document.getElementById('summaryList').innerHTML = html;
        }

        // =========================================================
        // LEAD CARDS
        // =========================================================

        function addLeadCard() {
            if (state.data.leads.length >= 5) return;
            state.data.leads.push({ name: '', phone: '', company: '', email: '' });
            renderLeadCards();
            addLeadBtn.disabled = state.data.leads.length >= 5;
            // Focus the phone input of the new card
            const cards = leadCardsEl.querySelectorAll('.lead-card');
            const lastCard = cards[cards.length - 1];
            if (lastCard) {
                const phoneInput = lastCard.querySelector('[data-lead-field="phone"]');
                if (phoneInput) phoneInput.focus();
            }
            saveToLocalStorage();
        }

        function removeLeadCard(i) {
            if (state.data.leads.length <= 1) return;
            state.data.leads.splice(i, 1);
            renderLeadCards();
            addLeadBtn.disabled = state.data.leads.length >= 5;
            saveToLocalStorage();
        }

        function renderLeadCards() {
            leadCardsEl.innerHTML = state.data.leads.map((lead, i) => `
                <div class="lead-card">
                    <div class="lead-card-header">
                        <span class="lead-card-number">Lead ${i + 1}</span>
                        ${i > 0 ? `
                            <button type="button" class="btn-icon" data-remove-lead="${i}" aria-label="Remove lead ${i + 1}">
                                <svg width="14" height="14" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                                </svg>
                            </button>
                        ` : ''}
                    </div>
                    <div class="lead-card-grid">
                        <div class="form-group">
                            <label class="form-label">Name</label>
                            <input type="text" class="form-input" placeholder="Lead's name" value="${esc(lead.name)}" data-lead-index="${i}" data-lead-field="name" aria-label="Lead ${i + 1} name">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Phone <span class="required">*</span></label>
                            <input type="tel" class="form-input" placeholder="+1 555 123 4567" value="${esc(lead.phone)}" data-lead-index="${i}" data-lead-field="phone" aria-label="Lead ${i + 1} phone">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Company</label>
                            <input type="text" class="form-input" placeholder="Company name" value="${esc(lead.company)}" data-lead-index="${i}" data-lead-field="company" aria-label="Lead ${i + 1} company">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Email</label>
                            <input type="email" class="form-input" placeholder="lead@company.com" value="${esc(lead.email)}" data-lead-index="${i}" data-lead-field="email" aria-label="Lead ${i + 1} email">
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // =========================================================
        // TOPIC & GOAL SELECTION
        // =========================================================

        const TOPIC_LABELS = {
            options: 'Options Trading',
            technical_analysis: 'Technical Analysis',
            forex: 'Forex Trading',
            risk_management: 'Risk Management'
        };

        function selectTopic(topic) {
            state.data.topic = topic;
            state.data.goal = 'trade_education'; // Always set goal to trade_education
            state.data.product = TOPIC_LABELS[topic] || topic; // Set product to topic label

            // Update radio button
            const r = document.querySelector(`input[name="topic"][value="${topic}"]`);
            if (r) r.checked = true;

            // Update product field
            const productField = document.getElementById('product');
            if (productField) productField.value = TOPIC_LABELS[topic] || topic;

            // Update visual selection
            document.querySelectorAll('.goal-card').forEach(c => {
                c.classList.toggle('selected', c.dataset.topic === topic);
            });

            saveToLocalStorage();
        }

        function selectGoal(g) {
            state.data.goal = g;
            const r = document.querySelector(`input[name="goal"][value="${g}"]`);
            if (r) r.checked = true;
            updateUI();
            saveToLocalStorage();
        }

        // =========================================================
        // FORM INPUT HANDLING
        // =========================================================

        function handleFormInput(e) {
            const { name, value, type, checked } = e.target;
            // Skip lead card inputs (handled separately) and goal/topic radios
            if (e.target.dataset.leadField !== undefined) return;
            if (name && name !== 'goal' && name !== 'topic') {
                state.data[name] = type === 'checkbox' ? checked : value;
                saveToLocalStorage();
                clearFieldError(name);

                // Add valid class for visual feedback
                if (value && e.target.classList.contains('form-input')) {
                    e.target.classList.add('valid');
                } else {
                    e.target.classList.remove('valid');
                }
            }
        }

        // =========================================================
        // VALIDATION
        // =========================================================

        function validateCurrentStep() {
            clearAllErrors();
            let valid = true;

            if (state.currentStep === 1) {
                state.data.owner_email = document.getElementById('owner_email').value.trim();

                if (!state.data.owner_email) {
                    showFieldError('owner_email', 'Please enter your email address');
                    valid = false;
                } else if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(state.data.owner_email)) {
                    showFieldError('owner_email', 'Please enter a valid email address');
                    valid = false;
                }
            } else if (state.currentStep === 2) {
                // For TradeTutor, topic selection is always valid (default: options)
                if (!state.data.topic) {
                    state.data.topic = 'options';
                }
                state.data.goal = 'trade_education';
            } else if (state.currentStep === 3) {
                state.data.product = document.getElementById('product').value.trim();
                state.data.context = document.getElementById('context').value.trim();

                if (!state.data.product) {
                    showFieldError('product', 'Please enter what you want to learn');
                    valid = false;
                }
            } else if (state.currentStep === 4) {
                // Sync lead data from DOM
                syncLeadsFromDOM();

                const leadsWithPhone = state.data.leads.filter(l => l.phone.trim());
                if (!leadsWithPhone.length) {
                    showFieldError('leads', 'Please add at least one lead with a phone number');
                    valid = false;
                } else {
                    // Validate phone formats
                    for (let i = 0; i < leadsWithPhone.length; i++) {
                        const cleaned = leadsWithPhone[i].phone.replace(/[\s\-()]/g, '');
                        if (!/^\+[1-9]\d{6,14}$/.test(cleaned)) {
                            showFieldError('leads', 'Please use international format for phone numbers: +1 555 123 4567');
                            valid = false;
                            break;
                        }
                    }

                    // Check for duplicate phones
                    if (valid) {
                        const phones = leadsWithPhone.map(l => l.phone.replace(/[\s\-()]/g, ''));
                        const unique = new Set(phones);
                        if (unique.size !== phones.length) {
                            showFieldError('leads', 'Duplicate phone numbers are not allowed');
                            valid = false;
                        }
                    }
                }
            } else if (state.currentStep === 5) {
                state.data.consent = document.getElementById('consent').checked;
                if (!state.data.consent) {
                    showFieldError('consent', 'Please confirm you have consent to make these calls');
                    valid = false;
                }
            }

            return valid;
        }

        function syncLeadsFromDOM() {
            const cards = leadCardsEl.querySelectorAll('.lead-card');
            cards.forEach((card, i) => {
                if (state.data.leads[i]) {
                    const fields = card.querySelectorAll('[data-lead-field]');
                    fields.forEach(f => {
                        state.data.leads[i][f.dataset.leadField] = f.value;
                    });
                }
            });
        }

        // =========================================================
        // ERROR HANDLING
        // =========================================================

        function showFieldError(f, m) {
            const e = document.getElementById(`${f}_error`);
            const i = document.getElementById(f);
            if (e) {
                e.textContent = m;
                e.classList.add('visible');
            }
            if (i) {
                i.classList.add('error');
                i.classList.remove('valid');
            }
        }

        function clearFieldError(f) {
            const e = document.getElementById(`${f}_error`);
            const i = document.getElementById(f);
            if (e) {
                e.textContent = '';
                e.classList.remove('visible');
            }
            if (i) i.classList.remove('error');
        }

        function clearAllErrors() {
            document.querySelectorAll('.form-error').forEach(e => {
                e.textContent = '';
                e.classList.remove('visible');
            });
            document.querySelectorAll('.form-input.error').forEach(e => e.classList.remove('error'));
            globalError.classList.remove('visible');
        }

        function showGlobalError(m) {
            document.getElementById('globalErrorMessage').textContent = m;
            globalError.classList.add('visible');
        }

        // =========================================================
        // FORM SUBMISSION
        // =========================================================

        async function submitForm() {
            if (!validateCurrentStep()) return;

            state.isSubmitting = true;
            updateUI();
            globalError.classList.remove('visible');

            try {
                const payload = {
                    owner_email: state.data.owner_email,
                    leads: state.data.leads
                        .filter(l => l.phone.trim())
                        .map(l => ({
                            phone: l.phone.replace(/[\s\-()]/g, ''),
                            name: l.name || undefined,
                            company: l.company || undefined,
                            email: l.email || undefined,
                        })),
                    product: state.data.product,
                    goal: state.data.goal,
                    consent: state.data.consent
                };

                if (state.data.context) payload.context = state.data.context;
                if (state.data.website_url) payload.website_url = state.data.website_url;
                if (state.data.booking_link) payload.booking_link = state.data.booking_link;
                if (state.data.payment_link) payload.payment_link = state.data.payment_link;
                if (state.data.pricing_summary) payload.pricing_summary = state.data.pricing_summary;
                if (state.data.urgency_hook) payload.urgency_hook = state.data.urgency_hook;
                if (state.data.goal_criteria) payload.goal_criteria = state.data.goal_criteria;

                const res = await fetch('https://novalabs.ae/calls', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                const data = await res.json();

                if (!res.ok) {
                    throw new Error(data.detail || 'Failed to start call');
                }

                document.getElementById('successDispatched').textContent = `${data.dispatched || 0} of ${data.total || 0}`;
                document.getElementById('successFailed').textContent = data.failed || '0';

                // Show per-lead call results
                const callsList = document.getElementById('successCallsList');
                if (data.calls && data.calls.length) {
                    callsList.innerHTML = data.calls.map(c => `
                        <div style="padding: var(--space-3); margin-bottom: var(--space-2); background: var(--bg-glass); border: 1px solid var(--border-default); border-radius: var(--radius-md);">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <span style="color: var(--text-primary); font-weight: 500;">${c.lead_name || c.phone}</span>
                                <span style="color: ${c.status === 'failed' ? 'var(--error)' : 'var(--success)'}; font-size: 0.85em;">${c.status}</span>
                            </div>
                            ${c.lead_name ? `<div style="color: var(--text-muted); font-size: 0.85em;">${c.phone}</div>` : ''}
                        </div>
                    `).join('');

                    // Store room name for "Join as Test Caller" button
                    storeRoomName(data);
                }

                state.currentStep = 'success';
                clearLocalStorage();
                updateUI();

            } catch (err) {
                showGlobalError(err.message || 'Something went wrong. Please try again.');
            } finally {
                state.isSubmitting = false;
                updateUI();
            }
        }

        // =========================================================
        // FORM RESET
        // =========================================================

        function resetForm() {
            state.currentStep = 1;
            state.data = {
                owner_email: '',
                leads: [{ name: 'Learner', phone: '', company: '', email: '' }],
                product: 'Options trading basics',
                website_url: '',
                context: '',
                goal: 'trade_education',
                booking_link: '',
                payment_link: '',
                pricing_summary: '',
                urgency_hook: '',
                goal_criteria: '',
                consent: false
            };
            form.reset();
            renderLeadCards();
            addLeadBtn.disabled = false;
            updateUI();
        }

        // =========================================================
        // LOCAL STORAGE
        // =========================================================

        const STORAGE_KEY = 'ai_voice_agent_form';

        function saveToLocalStorage() {
            try {
                localStorage.setItem(STORAGE_KEY, JSON.stringify({
                    currentStep: state.currentStep,
                    data: state.data,
                    savedAt: Date.now()
                }));
            } catch {}
        }

        function loadFromLocalStorage() {
            try {
                const s = localStorage.getItem(STORAGE_KEY);
                if (s) {
                    const p = JSON.parse(s);

                    // TTL check  clear if older than 30 minutes
                    if (p.savedAt && Date.now() - p.savedAt > 30 * 60 * 1000) {
                        clearLocalStorage();
                        return;
                    }

                    if (p.data) {
                        // Migrate old format: convert phones+name to leads
                        if (p.data.phones && !p.data.leads) {
                            p.data.leads = p.data.phones
                                .filter(ph => ph.trim())
                                .map(ph => ({
                                    name: p.data.name || '',
                                    phone: ph,
                                    company: '',
                                    email: ''
                                }));
                            if (!p.data.leads.length) {
                                p.data.leads = [{ name: '', phone: '', company: '', email: '' }];
                            }
                            delete p.data.phones;
                            delete p.data.name;
                        }

                        // Ensure leads array is valid
                        if (!Array.isArray(p.data.leads) || !p.data.leads.length) {
                            p.data.leads = [{ name: '', phone: '', company: '', email: '' }];
                        }

                        state.data = { ...state.data, ...p.data };
                        state.currentStep = p.currentStep || 1;
                        if (state.currentStep === 'success' || state.currentStep > 5) {
                            state.currentStep = 1;
                        }
                        populateFormFromState();
                    }
                }
            } catch {}
        }

        function populateFormFromState() {
            ['owner_email', 'product', 'website_url', 'context', 'booking_link', 'payment_link', 'pricing_summary', 'urgency_hook', 'goal_criteria'].forEach(f => {
                const e = document.getElementById(f);
                if (e && state.data[f]) e.value = state.data[f];
            });

            renderLeadCards();

            if (state.data.goal) {
                const r = document.querySelector(`input[name="goal"][value="${state.data.goal}"]`);
                if (r) r.checked = true;
            }

            document.getElementById('consent').checked = state.data.consent;
            addLeadBtn.disabled = state.data.leads.length >= 5;
        }

        function clearLocalStorage() {
            try {
                localStorage.removeItem(STORAGE_KEY);
            } catch {}
        }

        // =========================================================
        // UTILITIES
        // =========================================================

        function esc(s) {
            if (!s) return '';
            const d = document.createElement('div');
            d.textContent = s;
            return d.innerHTML;
        }

        // =========================================================
        // LIVEKIT VOICE CONNECTION
        // =========================================================

        let currentRoom = null;
        let currentRoomName = null;
        let localAudioTrack = null;
        let isMuted = false;

        // Store the first call's room name for joining
        function storeRoomName(callsData) {
            if (callsData.calls && callsData.calls.length > 0) {
                const firstCall = callsData.calls[0];
                // Room name format: call-{context_id}
                currentRoomName = `call-${firstCall.context_id}`;
                // Show the join button
                document.getElementById('joinCallBtn').style.display = 'flex';
            }
        }

        async function joinAsTestCaller() {
            if (!currentRoomName) {
                alert('No active call to join');
                return;
            }

            const voiceOverlay = document.getElementById('voiceOverlay');
            const voiceStatus = document.getElementById('voiceStatus');
            const voiceCircle = document.getElementById('voiceCircle');

            voiceOverlay.style.display = 'flex';
            voiceStatus.textContent = 'Requesting microphone...';

            try {
                // Request microphone permission first
                const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
                stream.getTracks().forEach(t => t.stop()); // Stop the test stream

                voiceStatus.textContent = 'Getting token...';

                // Get token from API
                const tokenRes = await fetch('https://novalabs.ae/token', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        room_name: currentRoomName,
                        participant_name: 'Test Caller'
                    })
                });

                if (!tokenRes.ok) {
                    const err = await tokenRes.json();
                    throw new Error(err.detail || 'Failed to get token');
                }

                const { server_url, participant_token } = await tokenRes.json();

                voiceStatus.textContent = 'Connecting to room...';

                // Connect to LiveKit room
                currentRoom = new LivekitClient.Room({
                    audioCaptureDefaults: {
                        autoGainControl: true,
                        echoCancellation: true,
                        noiseSuppression: true
                    }
                });

                // Set up event handlers
                currentRoom.on(LivekitClient.RoomEvent.TrackSubscribed, (track, publication, participant) => {
                    if (track.kind === 'audio') {
                        const audioEl = track.attach();
                        audioEl.id = 'agent-audio';
                        document.body.appendChild(audioEl);
                        voiceCircle.classList.add('agent-speaking');
                    }
                });

                currentRoom.on(LivekitClient.RoomEvent.TrackUnsubscribed, (track) => {
                    if (track.kind === 'audio') {
                        track.detach().forEach(el => el.remove());
                        voiceCircle.classList.remove('agent-speaking');
                    }
                });

                currentRoom.on(LivekitClient.RoomEvent.Disconnected, () => {
                    voiceStatus.textContent = 'Disconnected';
                    setTimeout(() => {
                        voiceOverlay.style.display = 'none';
                        cleanupCall();
                    }, 1500);
                });

                currentRoom.on(LivekitClient.RoomEvent.ParticipantConnected, (participant) => {
                    if (participant.identity.includes('agent')) {
                        voiceStatus.textContent = 'Agent connected - speak now!';
                    }
                });

                // Connect
                await currentRoom.connect(server_url, participant_token);
                voiceStatus.textContent = 'Connected - waiting for agent...';

                // Publish microphone
                await currentRoom.localParticipant.setMicrophoneEnabled(true);
                voiceStatus.textContent = 'Connected - speak now!';

                // Check if agent is already in the room
                currentRoom.remoteParticipants.forEach(p => {
                    if (p.identity.includes('agent')) {
                        voiceStatus.textContent = 'Connected to agent - speak now!';
                    }
                });

            } catch (err) {
                console.error('Voice connection error:', err);
                voiceStatus.textContent = `Error: ${err.message}`;
                setTimeout(() => {
                    voiceOverlay.style.display = 'none';
                }, 3000);
            }
        }

        function toggleMute() {
            if (!currentRoom) return;

            isMuted = !isMuted;
            currentRoom.localParticipant.setMicrophoneEnabled(!isMuted);

            const muteBtn = document.getElementById('muteBtn');
            const muteLabel = document.getElementById('muteLabel');

            if (isMuted) {
                muteBtn.classList.add('muted');
                muteLabel.textContent = 'Unmute';
            } else {
                muteBtn.classList.remove('muted');
                muteLabel.textContent = 'Mute';
            }
        }

        async function disconnectCall() {
            if (currentRoom) {
                await currentRoom.disconnect();
            }
            document.getElementById('voiceOverlay').style.display = 'none';
            cleanupCall();
        }

        function cleanupCall() {
            if (currentRoom) {
                currentRoom.disconnect();
                currentRoom = null;
            }
            // Remove any attached audio elements
            const agentAudio = document.getElementById('agent-audio');
            if (agentAudio) agentAudio.remove();

            // Reset UI
            isMuted = false;
            document.getElementById('muteBtn').classList.remove('muted');
            document.getElementById('muteLabel').textContent = 'Mute';
            document.getElementById('voiceCircle').classList.remove('agent-speaking', 'speaking');
        }
    </script>

    <!-- LiveKit Client SDK -->
    <script src="https://cdn.jsdelivr.net/npm/livekit-client@2/dist/livekit-client.umd.min.js"></script>
</body>
</html>
